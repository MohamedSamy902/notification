# Advanced Notifications Package (ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงููุชูุฏู) ๐

ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุงูู ูุงุญุชุฑุงูู ูุจูุฆุฉ ุนูู Laravelุ ูุฏุนู ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุฉ (Real-time) ุนุจุฑ Reverb/Pusherุ ูุฅุดุนุงุฑุงุช ุงููุงุชู/ุงููุชุตูุญ ุนุจุฑ Firebase (FCM)ุ ูุน ููุญุฉ ุชุญูู ูุชุทูุฑุฉ ููุชุญูููุงุช ูุฅุฏุงุฑุฉ ุงูุญููุงุช.

---

## ๐ ุงููููุฒุงุช

- **ุฅุดุนุงุฑุงุช ููุฑูุฉ (Real-time)**: ุฏุนู ูุงูู ูู Laravel Reverb ู Pusher ูุน ุชุญุฏูุซุงุช ุญูุฉ.
- **Firebase Cloud Messaging (FCM)**:
  - ุฅุฑุณุงู ูููุณุชุฎุฏููู (Tokens).
  - ุฅุฑุณุงู ููููุถูุนุงุช (Topics).
  - ูุนุงูุฌุฉ ุฐููุฉ ููุฃุฎุทุงุก (ุญุฐู ุงูุชูููุงุช ุงูููุชููุฉ ุชููุงุฆูุงู).
- **ุชุญูููุงุช ูุชูุฏูุฉ (Analytics)**:
  - ุชุชุจุน ุงูุฅุฑุณุงู (Sent).
  - ุชุชุจุน ุงููุตูู (Delivered) - _ููููุจ_.
  - ุชุชุจุน ุงููุฑุงุกุฉ (Read).
  - ุชุชุจุน ุงูููุฑ (Clicked).
- **ููุญุฉ ุชุญูู (Dashboard)**: ูุงุฌูุฉ ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ููุดุงูุฏุฉ ุงูุฅุญุตุงุฆูุงุช.
- **ููููุงุช Blade ุฌุงูุฒุฉ**: ุฏูุฌ ุณูู ูู ุงููุฑููุช ุฅูุฏ ุจู ุณุทุฑ ูุงุญุฏ.

---

## ๐ ุฏููู ุงูุชุซุจูุช (Installation)

### 1. ุชุซุจูุช ุงูุจุงูุฏุฌ

```bash
composer require advanced-notifications/core
```

### 2. ูุดุฑ ุงููููุงุช

```bash
php artisan vendor:publish --provider="AdvancedNotifications\AdvancedNotificationsServiceProvider"
```

### 3. ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
php artisan notifications:table
php artisan migrate
```

---

## โ๏ธ ุงูุฅุนุฏุงุฏ ูุงูุชููุฆุฉ (Configuration)

### 1. ุฅุนุฏุงุฏ ููู `.env`

ุฃุถู ุงููุชุบูุฑุงุช ุงูุชุงููุฉ ูู ููู `.env` ุงูุฎุงุต ุจูุดุฑูุนู:

**ุฅุนุฏุงุฏุงุช Firebase (ููุฅุดุนุงุฑุงุช):**

```env
FIREBASE_CREDENTIALS_PATH=/path/to/your/firebase_credentials.json
FIREBASE_API_KEY=AIzaSy...
FIREBASE_AUTH_DOMAIN=your-app.firebaseapp.com
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_STORAGE_BUCKET=your-app.appspot.com
FIREBASE_MESSAGING_SENDER_ID=123456789
FIREBASE_APP_ID=1:123456789:web:abcdef
FIREBASE_VAPID_KEY=B... (ุงูููุชุงุญ ุงูุนุงู ุงูุทููู)
```

**ุฅุนุฏุงุฏุงุช Reverb (ููุฅุดุนุงุฑุงุช ุงูููุฑูุฉ):**

```env
REVERB_APP_ID=...
REVERB_APP_KEY=...
REVERB_APP_SECRET=...
REVERB_HOST="localhost"
REVERB_PORT=8080
REVERB_SCHEME="http"

VITE_REVERB_APP_KEY="${REVERB_APP_KEY}"
VITE_REVERB_HOST="${REVERB_HOST}"
VITE_REVERB_PORT="${REVERB_PORT}"
VITE_REVERB_SCHEME="${REVERB_SCHEME}"
```

### 2. ุฅุนุฏุงุฏ ููุฏูู ุงููุณุชุฎุฏู (`User.php`)

ุฃุถู ุงูู Trait `HasAdvancedNotifications` ูู ููุฏูู ุงููุณุชุฎุฏู:

```php
use AdvancedNotifications\Traits\HasAdvancedNotifications;

class User extends Authenticatable
{
    use HasAdvancedNotifications;
    // ...
}
```

### 3. ุฅุนุฏุงุฏ ูููุงุช ุงูุจุซ (`routes/channels.php`)

ุชุฃูุฏ ูู ูุฌูุฏ ุชุตุฑูุญ ููููุงุฉ ุงูุฎุงุตุฉ ุจุงููุณุชุฎุฏู:

```php
Broadcast::channel('App.Models.User.{id}', function ($user, $id) {
    return (int) $user->id === (int) $id;
});
```

---

## ๐ป ุงูุงุณุชุฎุฏุงู (Usage)

### 1. ุฏูุฌ ุงูุฅุดุนุงุฑุงุช ูู ุงููุฑููุช ุฅูุฏ (Frontend)

ููุท ุฃุถู ูุฐุง ุงูุณุทุฑ ูู ููู ุงูู Layout ุงูุฑุฆูุณู (ูุจู ุฅุบูุงู `</body>`):

```html
<x-advanced-notifications::scripts topic="1" user-id="{{ auth()->id() }}" />
```

- **topic="1"**: (ุงุฎุชูุงุฑู) ููุงุดุชุฑุงู ุชููุงุฆูุงู ูู ููุถูุน ูุนูู.
- **user-id**: (ุถุฑูุฑู) ูุชูุนูู ุงูุฅุดุนุงุฑุงุช ุงูุฎุงุตุฉ ุจุงููุณุชุฎุฏู.

ูุฐุง ุงููููู ุณูููู ุชููุงุฆูุงู ุจู:

1.  ุชุญููู ููุชุจุงุช Firebase ู Echo.
2.  ุทูุจ ุฅุฐู ุงูุฅุดุนุงุฑุงุช.
3.  ุงูุงุณุชูุงุน ูููููุงุช ุงูุฎุงุตุฉ.
4.  ุนุฑุถ ุงูุฅุดุนุงุฑุงุช ุจู **SweetAlert** ุฌููู.
5.  ุฅุฑุณุงู ุชูุงุฑูุฑ "ุชู ุงููุตูู" ู "ุชู ุงูููุฑ" ููุจุงู ุฅูุฏ.

### 2. ุฅุฑุณุงู ุฅุดุนุงุฑ ุจุฑูุฌูุงู (Code)

```php
use AdvancedNotifications\Notifications\GenericNotification;
use App\Models\User;

$user = User::find(1);

$user->notify(new GenericNotification(
    'ุนููุงู ุงูุฅุดุนุงุฑ',
    'ูุต ุงูุฅุดุนุงุฑ ููุง...',
    null,               // ุงูุฃููููุฉ
    'https://google.com', // ุฑุงุจุท ุนูุฏ ุงูููุฑ
    [],                 // ุจูุงูุงุช ุฅุถุงููุฉ
    ['broadcast', 'database', 'fcm'] // ุงููููุงุช
));
```

---

## ๐งช ุฎุทุฉ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู (Final Testing Plan)

ุงุชุจุน ูุฐู ุงูุฎุทูุงุช ููุชุฃูุฏ ูู ุฃู ุงููุธุงู ูุนูู 100%:

### ุงูุงุฎุชุจุงุฑ 1: ุงูุฅุฑุณุงู ููุณุชุฎุฏู ูุงุญุฏ (Single User)

1.  ุงูุชุญ ููุญุฉ ุงูุชุญูู: `/advanced-notifications/send`.
2.  ุงุฎุชุฑ **Target Type**: `User`.
3.  ุฃุฏุฎู **Recipient ID**: ุฑูู ุงููุณุชุฎุฏู ุงูุฎุงุต ุจู (ูุซูุงู `1`).
4.  ุงุฎุชุฑ ุงููููุงุช: `Database`, `Realtime`, `FCM`.
5.  ุงุถุบุท **Send**.
    - โ **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุธูุฑ SweetAlert ููุฑุงูุ ููุตู ุฅุดุนุงุฑ ูุชุตูุญ (FCM)ุ ููุชู ุชุณุฌูู ุงูุฅุดุนุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

### ุงูุงุฎุชุจุงุฑ 2: ุงูุฅุฑุณุงู ูุนุฏุฉ ูุณุชุฎุฏููู (Multiple Users)

1.  ูู ููุณ ุงูุตูุญุฉุ ุฃุฏุฎู ูู **Recipient ID**: `1,2` (ุฃุฑูุงู ูุณุชุฎุฏููู ููุฌูุฏูู).
2.  ุงุถุบุท **Send**.
    - โ **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุตู ุงูุฅุดุนุงุฑ ูููุง ุงููุณุชุฎุฏูููุ ููุชู ุชุณุฌูู ุณุฌููู ูู ุงูุชุญูููุงุช.

### ุงูุงุฎุชุจุงุฑ 3: ุงูุฅุฑุณุงู ูููุถูุน (Topic)

1.  ุชุฃูุฏ ุฃูู ูุดุชุฑู ูู ุงูุชูุจูู (ุนุจุฑ ููุฏ ุงูู Blade `topic="news"` ูุซูุงู).
2.  ุงุฎุชุฑ **Target Type**: `Topic`.
3.  ุฃุฏุฎู ุงุณู ุงูุชูุจูู: `news`.
4.  ุงุถุบุท **Send**.
    - โ **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุตู ุฅุดุนุงุฑ FCM ูุฌููุน ุงููุดุชุฑููู ูู ูุฐุง ุงูุชูุจูู.

### ุงูุงุฎุชุจุงุฑ 4: ุงูุฅุฑุณุงู ุงูุฌูุงุนู (Mass Send)

1.  ุงุฎุชุฑ **Target Type**: `All Users`.
2.  ุงุถุบุท **Send**.
    - โ **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุชู ุฌุฏููุฉ ุงูุฅุฑุณุงู ูุฌููุน ุงููุณุชุฎุฏููู ูู ุงููุธุงู (ุนูู ุฏูุนุงุช).

### ุงูุงุฎุชุจุงุฑ 5: ุงูุชุญูููุงุช (Analytics)

1.  ุจุนุฏ ูุตูู ุงูุฅุดุนุงุฑ (SweetAlert)ุ ูุง ุชุถุบุท ุนููู ููุฑุงู.
2.  ุงุฐูุจ ูุฌุฏูู `notification_analytics` ูู ุงูุฏุงุชุงุจูุณ.
    - โ ูุฌุจ ุฃู ุชุฌุฏ ุณุฌู `event_type = delivered`.
3.  ุงุถุบุท ุนูู ุงูุฅุดุนุงุฑ.
    - โ ูุฌุจ ุฃู ูุชู ุชูุฌููู ููุฑุงุจุท.
    - โ ูุฌุจ ุฃู ุชุฌุฏ ุณุฌู `event_type = clicked`.
    - โ ูุฌุจ ุฃู ุชุชุญุฏุซ ุญุงูุฉ ุงูุฅุดุนุงุฑ ูู ุฌุฏูู `advanced_notifications` ูุชุตุจุญ `read_at` ููุง ูููุฉ.

---

ุชู ุงูุชุทููุฑ ุจุญุจ โค๏ธ ุจูุงุณุทุฉ [ูุฑููู]
