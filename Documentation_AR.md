# AdvancedNotifications - ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุฏู ูู Laravel

ูุฐู ุงูุญุฒูุฉ ุชููุฑ ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุงูู ูููู ููุดุงุฑูุน Laravelุ ูุน ุฏุนู ูุนุฏุฉ ูููุงุช (Firebase, Database, Real-time, Email, SMS) ูููุฒุงุช ูุชูุฏูุฉ ูุซู ุงูุฌุฏููุฉ ูุงูุญููุงุช.

## ๐ ุงููููุฒุงุช

- **ุฏุนู ูุชุนุฏุฏ ุงููููุงุช**: ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุนุจุฑ Firebase (FCM)ุ ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุงูุจุฑูุฏ ุงูุฅููุชุฑูููุ ุงูุฑุณุงุฆู ุงููุตูุฑุฉ (SMS)ุ ู Webhooks.
- **ูุชุนุฏุฏ ุงููุบุงุช**: ุฏุนู ูุฏูุฌ ููุชุฑุฌูุฉ ุจุงุณุชุฎุฏุงู `spatie/laravel-translatable`.
- **ูุธุงู ุงูููุงูุจ**: ููุงูุจ ุฏููุงููููุฉ ูุน ูุชุบูุฑุงุช ูุฏุนู ููุบุงุช ูุชุนุฏุฏุฉ.
- **ุงูุญููุงุช (Campaigns)**: ุฅูุดุงุก ูุฌุฏููุฉ ูุฅุฏุงุฑุฉ ุญููุงุช ุฅุดุนุงุฑุงุช ุฌูุงุนูุฉ.
- **ุงูุฅุดุนุงุฑุงุช ุงููุฌุฏููุฉ**: ุชุญุฏูุฏ ููุช ุฏููู ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช.
- **ุชูุถููุงุช ุงููุณุชุฎุฏู**: ุงูุณูุงุญ ูููุณุชุฎุฏููู ุจุงูุชุญูู ูู ุงููููุงุช ุงูุชู ููุถููููุง ูุฃููุงุช ุนุฏู ุงูุฅุฒุนุงุฌ.
- **ุงูููุช ุงููุนูู (Real-Time)**: ุชูุงูู ูุน WebSockets ูุชุญุฏูุซุงุช ููุฑูุฉ.
- **ุชุญูููุงุช**: ุชุชุจุน ูุนุฏูุงุช ุงูุชุณููู ูุงููุฑุงุกุฉ ูุงูููุฑ.

---

## ๐ฆ ุงูุชุซุจูุช

1.  **ุชุซุจูุช ุงูุญุฒูุฉ ุนุจุฑ Composer:**

    ```bash
    composer require advanced-notifications/core
    ```

2.  **ุชุซุจูุช ุงูุญุฒูุฉ ุชููุงุฆูุงู:**

    ```bash
    php artisan advanced-notifications:install
    ```

    ูุฐุง ุงูุฃูุฑ ุณูููู ุจูุดุฑ ูููุงุช ุงูุฅุนุฏุงุฏ ูุงูู Migrations ูุนุฑุถ ุฎูุงุฑ ูุชุดุบูููุง.

3.  **ุฅุถุงูุฉ ุงูู Trait ุฅูู ููุฏูู ุงููุณุชุฎุฏู (User):**

    ```php
    use AdvancedNotifications\Traits\HasAdvancedNotifications;

    class User extends Authenticatable
    {
        use HasAdvancedNotifications;
    }
    ```

---

## ๐ฑ ุชุณุฌูู ุงูุฃุฌูุฒุฉ (FCM Tokens)

ูุชููู ุฅุดุนุงุฑุงุช Firebaseุ ูุฌุจ ุชุณุฌูู ุชููู ุงูุฌูุงุฒ ุงูุฎุงุต ุจุงููุณุชุฎุฏู ุนุจุฑ ุงูู API:

**Endpoint:** `POST /api/notifications/register-token`

**Body:**

```json
{
  "token": "fcm_device_token_here",
  "device_type": "android" // or ios, web
}
```

ูุฐุง ุณูููู ุจุญูุธ ุงูุชููู ูู ุฌุฏูู `device_tokens` ูุฑุจุทู ุจุงููุณุชุฎุฏู ุงูุญุงูู.

---

## ๏ฟฝ ุงูุงุดุชุฑุงู ูู ุงูููุงุถูุน (Topics)

ููููู ุงูุงุดุชุฑุงู ูู ููุถูุน ูุนูู ูุชููู ุฅุดุนุงุฑุงุช ุฌูุงุนูุฉ:

**Endpoint:** `POST /api/notifications/topics/{id}/subscribe`

**Body:**

```json
{
  "token": "fcm_device_token_here"
}
```

ูุฅูุบุงุก ุงูุงุดุชุฑุงู: `POST /api/notifications/topics/{id}/unsubscribe`

---

## ๐ฅ๏ธ ุงุณุชุฎุฏุงู Blade (Frontend)

ุฅุฐุง ููุช ุชุณุชุฎุฏู Blade ูุชุฑูุฏ ุชูุนูู ุงูุฅุดุนุงุฑุงุช ูุชุณุฌูู ุงูุชููู ุชููุงุฆูุงูุ ููููู ุงุณุชุฎุฏุงู ุงููููู ุงูุฌุงูุฒ:

1.  ุชุฃูุฏ ูู ุฅุนุฏุงุฏ `firebase` ูู ููู `config/advanced-notifications.php`.
2.  ุฃุถู ุงููููู ูู ููู ุงูู Layout ุงูุฑุฆูุณู (ูุจู ุฅุบูุงู `</body>`):

```blade
<x-advanced-notifications::fcm-scripts :firebaseConfig="config('advanced-notifications.firebase.config')" />
```

ูุฐุง ุงููููู ุณูููู ุจู:

1.  ุชููุฆุฉ Firebase.
2.  ุทูุจ ุฅุฐู ุงูุฅุดุนุงุฑุงุช ูู ุงููุณุชุฎุฏู.
3.  ุงูุญุตูู ุนูู ุงูุชููู.
4.  ุฅุฑุณุงู ุงูุชููู ุชููุงุฆูุงู ุฅูู `/api/notifications/register-token`.

---

## ๏ฟฝ๐ ุงูุงุณุชุฎุฏุงู

### 1. ุฅุฑุณุงู ุฅุดุนุงุฑ (Firebase & Database)

ููููู ุฅุฑุณุงู ุฅุดุนุงุฑ ุจุณูุท ุจุงุณุชุฎุฏุงู ุงูู Facade:

```php
use AdvancedNotifications\Facades\AdvancedNotifications;
use AdvancedNotifications\Notifications\GeneralNotification;

// ุฅุฑุณุงู ููุณุชุฎุฏู ูุงุญุฏ
AdvancedNotifications::send($user, new GeneralNotification([
    'title' => 'ูุฑุญุจุงู ุจู',
    'body' => 'ุชู ุชุณุฌูู ุฏุฎููู ุจูุฌุงุญ',
    'icon' => 'https://example.com/icon.png',
    'action_url' => 'https://example.com/dashboard'
]));

// ุฅุฑุณุงู ููุฌููุนุฉ ูุณุชุฎุฏููู
AdvancedNotifications::send($users, new GeneralNotification([
    'title' => 'ุชุญุฏูุซ ุฌุฏูุฏ',
    'body' => 'ูููุง ุจุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ'
]));
```

### 2. ุงูุฅุดุนุงุฑุงุช ุงููุฌุฏููุฉ (Scheduled)

ูุฌุฏููุฉ ุฅุดุนุงุฑ ููุชู ุฅุฑุณุงูู ูู ููุช ูุงุญู:

```php
use AdvancedNotifications\Services\CampaignService;

$campaignService = app(CampaignService::class);

// ุฅูุดุงุก ุญููุฉ ูุฌุฏููุฉ
$campaign = $campaignService->createCampaign(
    'ุญููุฉ ุฑูุถุงู', // ุงุณู ุงูุญููุฉ
    $templateId,   // ูุนุฑู ุงููุงูุจ (ุงุฎุชูุงุฑู)
    ['segment' => 'all_users'], // ุงููุฆุฉ ุงููุณุชูุฏูุฉ
    now()->addDays(1) // ููุช ุงูุฅุฑุณุงู
);

// ุจุฏุก ุงูุญููุฉ (ุณูุชู ูุถุนูุง ูู ุงูุทุงุจูุฑ ููููุช ุงููุญุฏุฏ)
$campaignService->startCampaign($campaign);
```

### 3. ุฅุดุนุงุฑุงุช ุงูููุช ุงููุนูู (Real-Time)

ุชุฃูุฏ ูู ุฅุนุฏุงุฏ Laravel Reverb ุฃู Pusher ูู ูุดุฑูุนู. ุงูุญุฒูุฉ ุชุฏุนู ุงูุจุซ ุชููุงุฆูุงู ุนูุฏ ุงุณุชุฎุฏุงู ููุงุฉ `broadcast` ูู ุงูุฅุดุนุงุฑ.

```php
// ูู ููุงุณ ุงูุฅุดุนุงุฑ ุงูุฎุงุต ุจู
public function via($notifiable)
{
    return ['database', 'broadcast', 'fcm'];
}
```

### 4. ุงุณุชุฎุฏุงู ุงูููุงูุจ (Templates)

ููููู ุฅูุดุงุก ููุงูุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุณุชุฎุฏุงููุง ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ููุญุฏุฉ:

```php
use AdvancedNotifications\Services\TemplateService;

$templateService = app(TemplateService::class);

// ุงุณุชุฎุฏุงู ูุงูุจ ููุฌูุฏ
$content = $templateService->render('welcome_message', ['name' => 'ุฃุญูุฏ']);

// $content ุณูุญุชูู ุนูู ุงูุนููุงู ูุงููุต ุจุนุฏ ุงุณุชุจุฏุงู ุงููุชุบูุฑุงุช
```

---

## ๐ง ุงูุฅุนุฏุงุฏุงุช (Configuration)

ููู ุงูุฅุนุฏุงุฏ `config/advanced-notifications.php` ูุชูุญ ูู ุชุฎุตูุต:

- **ุงููููุงุช ุงูุงูุชุฑุงุถูุฉ**: `['database', 'fcm']` ูุซูุงู.
- **ุฅุนุฏุงุฏุงุช Firebase**: ููุงุชูุญ ุงูู API ู Project ID.
- **ุญุฏูุฏ ุงูุฅุฑุณุงู (Rate Limiting)**: ุนุฏุฏ ุงููุญุงููุงุช ุงููุณููุญุฉ.

---

## ๐ก ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API)

ุชููุฑ ุงูุญุฒูุฉ ููุงุท ูุตูู (Endpoints) ุฌุงูุฒุฉ:

| ุงูุทุฑููุฉ | ุงูุฑุงุจุท                              | ุงููุตู                      |
| :------ | :---------------------------------- | :------------------------- |
| `GET`   | `/api/notifications`                | ุนุฑุถ ูู ุงูุฅุดุนุงุฑุงุช           |
| `GET`   | `/api/notifications/unread`         | ุนุฑุถ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ |
| `POST`  | `/api/notifications/{id}/read`      | ุชุญุฏูุฏ ุฅุดุนุงุฑ ูููุฑูุก         |
| `POST`  | `/api/notifications/register-token` | ุชุณุฌูู ุชููู ุงูุฌูุงุฒ (FCM)    |

---

## ๐ ุงูุชุฑุฎูุต

ูุฐู ุงูุญุฒูุฉ ููุชูุญุฉ ุงููุตุฏุฑ ููุฑุฎุตุฉ ุชุญุช ุฑุฎุตุฉ [MIT](LICENSE.md).
