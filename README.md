# Advanced Notifications Package (ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงููุชูุฏู)

ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุงูู ูุงุญุชุฑุงูู ูุจูุฆุฉ ุนูู Laravelุ ูุตูู ููููู "ุจุงูุฏุฌ" ูุณุชูู ููุงุจู ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู. ูุฏุนู ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุฉ (Real-time) ูุฅุดุนุงุฑุงุช Firebase (FCM) ูุฅุฏุงุฑุฉ ุงูุญููุงุช ูุงูููุถูุนุงุช (Topics) ูู ุฎูุงู ููุญุฉ ุชุญูู ูุชุทูุฑุฉ.

---

## ๐ ุงููููุฒุงุช

- **ุฅุดุนุงุฑุงุช ููุฑูุฉ (Real-time)**: ุฏุนู ูุงูู ูู Laravel Reverb ู Pusher.
- **Firebase Cloud Messaging (FCM)**:
  - ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูููุณุชุฎุฏููู (Tokens).
  - ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ููููุถูุนุงุช (Topics).
  - ุฏุนู ุงููุตุงุฏูุฉ ุงูุญุฏูุซุฉ (OAuth2) ุงูุฎุงุตุฉ ุจู Google.
- **ููุญุฉ ุชุญูู (Dashboard)**: ูุงุฌูุฉ ุฑุณูููุฉ ูุฅุฏุงุฑุฉ ุงูุฅุดุนุงุฑุงุชุ ุงูููุถูุนุงุชุ ูุงูุฅุญุตุงุฆูุงุช.
- **ูุชุนุฏุฏ ุงููุบุงุช**: ุฏุนู ูุงูู ููุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ.
- **ุฅุฏุงุฑุฉ ุงูุชููู (Token Management)**: ุชุณุฌูู ูุญุฐู ุชููู ุงูุฃุฌูุฒุฉ ุชููุงุฆูุงู ุนุจุฑ API.

---

## ๐ ุฏููู ุงูุชุซุจูุช (ุฎุทูุฉ ุจุฎุทูุฉ)

ุงุชุจุน ูุฐู ุงูุฎุทูุงุช ุจุฏูุฉ ูุชุดุบูู ุงูุจุงูุฏุฌ ูู ูุดุฑูุนู ุงูุฌุฏูุฏ.

### 1. ุงููุชุทูุจุงุช (Requirements)

- PHP ^8.1
- Laravel ^10.0 ุฃู ^11.0
- ุญุณุงุจ Firebase (ูุฅุดุนุงุฑุงุช ุงููุงุชู/ุงููุชุตูุญ).

### 2. ุชุซุจูุช ุงูุจุงูุฏุฌ

ุจูุง ุฃู ุงูุจุงูุฏุฌ ูุชููุฑ ุงูุขู ุนูู Packagistุ ููููู ุชุซุจูุชู ูุจุงุดุฑุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุชุงูู:

```bash
composer require advanced-notifications/core
```

### 3. ูุดุฑ ุงููููุงุช (Publishing)

ูุญุชุงุฌ ููุดุฑ ูููุงุช ุงูุฅุนุฏุงุฏ ูุงููุงูุฌุฑูุดู (ููุงุนุฏ ุงูุจูุงูุงุช) ุงูุฎุงุตุฉ ุจุงูุจุงูุฏุฌ:

```bash
php artisan vendor:publish --provider="AdvancedNotifications\AdvancedNotificationsServiceProvider"
```

### 4. ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช

ูู ุจุชูููุฐ ุงูุฌุฏุงูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```bash
php artisan migrate
```

---

## โ๏ธ ุงูุฅุนุฏุงุฏ ูุงูุชููุฆุฉ (Configuration)

### 1. ุฅุนุฏุงุฏ Sanctum (ูุงู ุฌุฏุงู)

ูุนุชูุฏ ุงูุจุงูุฏุฌ ุนูู `laravel/sanctum` ูุชุฃููู ุงูู API ูุชุณุฌูู ุงูุชููู ูู ุงููุฑููุช ุฅูุฏ.

1.  ุซุจุช Sanctum (ุฅุฐุง ูู ููู ูุซุจุชุงู):

    ```bash
    composer require laravel/sanctum
    php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"
    php artisan migrate
    ```

2.  ุฃุถู `HasApiTokens` ูู ููุฏูู ุงููุณุชุฎุฏู `User.php`:

    ```php
    namespace App\Models;

    use Laravel\Sanctum\HasApiTokens; // <--- ุฃุถู ูุฐุง ุงูุณุทุฑ
    use AdvancedNotifications\Traits\HasAdvancedNotifications; // <--- ููุฐุง ุงูุณุทุฑ
    use Illuminate\Foundation\Auth\User as Authenticatable;

    class User extends Authenticatable
    {
        use HasApiTokens, HasAdvancedNotifications, ...; // <--- ูุงุณุชุฎุฏููู ููุง
    }
    ```

### 2. ุฅุนุฏุงุฏ Firebase (ููุฅุดุนุงุฑุงุช)

1.  ุงุฐูุจ ุฅูู [Firebase Console](https://console.firebase.google.com/).
2.  ุฃูุดุฆ ูุดุฑูุน ุฌุฏูุฏ ุฃู ุงุฎุชุฑ ูุดุฑูุน ุญุงูู.
3.  ุงุฐูุจ ุฅูู **Project Settings** > **Service accounts**.
4.  ุงุถุบุท ุนูู **Generate new private key**.
5.  ุณูุชู ุชุญููู ููู JSON. ูู ุจุชุบููุฑ ุงุณูู ุฅูู `firebase_credentials.json`.
6.  ุงููู ูุฐุง ุงูููู ุฅูู ูุฌูุฏ `storage/app/` ูู ูุดุฑูุนู.
7.  ุงูุชุญ ููู `.env` ูุฃุถู ุงููุณุงุฑ:

    ```env
    FIREBASE_CREDENTIALS_PATH=/var/www/html/your-project/storage/app/firebase_credentials.json
    ```

    _(ุชุฃูุฏ ูู ูุชุงุจุฉ ุงููุณุงุฑ ุงููุงูู ููููู)_

### 3. ุฅุนุฏุงุฏ ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุฉ (Real-time)

ููุตู ุจุงุณุชุฎุฏุงู **Laravel Reverb** ูุฃูู ูุฌุงูู ูุณุฑูุน.

1.  ุซุจุช Reverb:
    ```bash
    php artisan install:broadcasting
    ```
2.  ุดุบู ุณูุฑูุฑ Reverb:
    ```bash
    php artisan reverb:start
    ```
3.  ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช `.env`:
    ```env
    REVERB_SCHEME="http"
    ```

### 4. ุฅุนุฏุงุฏุงุช Firebase ูููุงุฌูุฉ ุงูุฃูุงููุฉ (Frontend)

ูุชุนูู ููุชุจุฉ ุงูุฌุงูุงุณูุฑูุจุช ุงููุฑููุฉุ ุฃุถู ูุฐู ุงููุชุบูุฑุงุช ูู ููู `.env`:

```env
FIREBASE_API_KEY=AIzaSy...
FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_STORAGE_BUCKET=your-project.appspot.com
FIREBASE_MESSAGING_SENDER_ID=123456789
FIREBASE_APP_ID=1:123456789:web:abcdef
FIREBASE_VAPID_KEY=B... (ุงูููุชุงุญ ุงูุทููู)
```

---

## ๐ป ุงูุงุณุชุฎุฏุงู (Usage)

### 1. ุชูุนูู ุงูุฅุดุนุงุฑุงุช ูู ุงููุฑููุช ุฅูุฏ (Blade)

ููุฏ ููุฑูุง ูู ูููู (Component) ุฌุงูุฒ ูููู ุจูู ุงูุนูู ุงูุตุนุจ (ุชููุฆุฉ Firebaseุ ุทูุจ ุงูุฅุฐูุ ุชุณุฌูู ุงูุชูููุ ูุงูุงุดุชุฑุงู ูู ุชูุจู).

ููุท ุฃุถู ูุฐุง ุงูุณุทุฑ ูู ููู ุงูู Layout ุงูุฑุฆูุณู (ูุซูุงู `layouts/app.blade.php`) ูุจู ุฅุบูุงู `</body>`:

```html
<x-advanced-notifications::firebase-scripts />
```

**ููุงุดุชุฑุงู ูู ุชูุจู ูุนูู ุชููุงุฆูุงู (ูุซูุงู ID ุฑูู 1):**

```html
<x-advanced-notifications::firebase-scripts topic="1" />
```

ูุฐุง ุงููููู ุณูููู ุจู:

1. ุชุญููู ููุชุจุงุช Firebase ุชููุงุฆูุงู.
2. ุทูุจ ุงูุฅุฐู ูู ุงููุณุชุฎุฏู.
3. ุฅุฑุณุงู ุงูุชููู ุฅูู ุงูุจุงู ุฅูุฏ ูุญูุธู.
4. ุงูุงุดุชุฑุงู ูู ุงูุชูุจู ุงููุญุฏุฏ (ุงุฎุชูุงุฑู).

### 1. ุฅุฑุณุงู ุฅุดุนุงุฑ ููุณุชุฎุฏู (Token Notification)

ูุฅุฑุณุงู ุฅุดุนุงุฑ ููุณุชุฎุฏู ูุนูู (ูุซูุงู ุนูุฏ ุญุฏูุซ ุญุฏุซ ูุนูู):

```php
use AdvancedNotifications\Notifications\GenericNotification;
use App\Models\User;

$user = User::find(1);

$user->notify(new GenericNotification(
    'ูุฑุญุจุงู ุจู!',              // ุงูุนููุงู
    'ุชู ุชูุนูู ุญุณุงุจู ุจูุฌุงุญ.',   // ุงููุต
    null,                      // ุงูุฃููููุฉ (ุงุฎุชูุงุฑู)
    null,                      // ุฑุงุจุท ุนูุฏ ุงูุถุบุท (ุงุฎุชูุงุฑู)
    [],                        // ุจูุงูุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)
    ['fcm', 'database']        // ุงููููุงุช: FCM ู ูุงุนุฏุฉ ุงูุจูุงูุงุช
));
```

### 2. ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุถูุน (Topic Notification)

ูุฅุฑุณุงู ุฅุดุนุงุฑ ููุฌููุนุฉ ูุดุชุฑููู (ูุซูุงู "ุฃุฎุจุงุฑ ุนุงุฌูุฉ"):

ุฃููุงู: ุงุดุชุฑู ุงููุณุชุฎุฏู ูู ุงูููุถูุน:

```php
$firebaseService = new \AdvancedNotifications\Services\FirebaseService();
$firebaseService->subscribeToTopic(['token_123'], 'news');
```

ุซุงููุงู: ุฃุฑุณู ููููุถูุน:

```php
$firebaseService->sendToTopic(
    'news',
    'ุฎุจุฑ ุนุงุฌู',
    'ุชูุงุตูู ุงูุฎุจุฑ ุงูููู...'
);
```

### 3. ููุญุฉ ุงูุชุญูู (Dashboard)

ุงูุจุงูุฏุฌ ูุฃุชู ูุน ููุญุฉ ุชุญูู ุฌุงูุฒุฉ!

- ุงูุชุญ ุงูุฑุงุจุท: `http://your-app.test/dashboard`
- ุณุชุฌุฏ ุฅุญุตุงุฆูุงุช ุงูุฅุฑุณุงูุ ุฅุฏุงุฑุฉ ุงูููุถูุนุงุชุ ูุฅููุงููุฉ ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูุฏููุฉ.

---

## โ ุงูุชุญูู ูู ุงูุนูู (Verification)

ููุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู ุจุดูู ุตุญูุญ:

1.  ุณุฌู ุงูุฏุฎูู ูู ุชุทุจููู.
2.  ุงูุชุญ ููุญุฉ ุงูุชุญูู `/dashboard`.
3.  ุณูุทูุจ ุงููุชุตูุญ "ุงูุณูุงุญ ุจุงูุฅุดุนุงุฑุงุช" (Allow Notifications). ูุงูู ุนููู.
4.  ุงุฐูุจ ูุตูุญุฉ "Send Notification" ูุฌุฑุจ ุงูุฅุฑุณุงู ูููุณู.
5.  ุฅุฐุง ูุตู ุงูุฅุดุนุงุฑุ ููุจุฑูู! ุงููุธุงู ูุนูู ุจูุฌุงุญ. ๐

---

ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ [Advanced Notifications Team]
